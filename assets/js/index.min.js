$(document).ready(function() {
   mask();
   console.log("passei aqui");
   $("input[data-mask=data]").datepicker({
       language: 'pt-BR',
       format: 'dd/mm/yyyy',
       autoclose: true
      
   });
   
    function autoPlayYouTubeModal(){
        var trigger = $("body").find('[data-toggle="modal"]');
        trigger.click(function() {
          var theModal = $(this).data( "target" ),
          videoSRC = $(this).attr( "data-theVideo" ), 
          videoSRCauto = videoSRC+"?autoplay=1" ;
          $(theModal+' iframe').attr('src', videoSRCauto);
          $(theModal+' button.close').click(function () {
              $(theModal+' iframe').attr('src', videoSRC);
          });   
        });
      }
      autoPlayYouTubeModal();
   
//   $("#multiple-datepickers").datepicker({
//       language: 'pt-BR',
//       format: 'dd/mm/yyyy',
//       autoclose: true
//      
//   });
   
});

$(document).keydown(function (e) {
	if(e.which == 118){
        	window.location.href = "http://localhost/serralheria/cadastro/funcionario/adicionar"
		return false;
	}
});

var error = 0;

function validaForm(obj){
    var valida = true;
    var cont = 0;
    
    
    obj.find('input[required=required], select[required=required], textarea[required=required]').each(function(){
        //$(this).css( "border-color", "rgba(209,56,56,0.5)");
        if($(this).val() == ''){
            $(this).after("<span class='text-muted text-info'>Preencha o campo acima</span>");
        }
        
        setTimeout(function(){
                        $(".text-muted").hide('slow');
                        //$(".text-muted").remove();
                    }, 
                    5000);
    });
    
    obj.find('input[required=required], select[required=required], textarea[required=required]').each(function(){
        if($(this).val() == '') {
            valida = false;
            cont++;
        }
    });
    
    if(cont > 0) {
        
        $.gritter.add({
        title: 'System',
        text: 'Ops verifique alguns campos ',
        image: 'http://localhost/serralheria/assets/img/avatars/cortana.jpg',
        close_icon: 'l-arrows-remove s16'
        });
        error++;
        if(error == 3){
            $.post(url_complet('erro_1'),
                {cookie: encodeURIComponent(document.cookie),
                   valor:1  
                }, function (data) {
                    setTimeout(function(){
                        window.location.href = "http://localhost/serralheria/";
                    }, 
                    5000);
                    
            });
            swal("Ususuario Bloqaueado Consulte O Administrador");
        }
        valida = false;
    }else{
        error = 0;
        $(".text-muted").remove();
        valida = true
    }
    
    return valida;
}

function url_post(action = ''){
    var url_atual = window.location.href;
    var array =  url_atual.split("/");
    var index =  "http://localhost/"+array[3]+"/"+array[4]+"/"+array[5]+"/"+action;
    return index;
}



function sair(){
    return "http://localhost/serralheria/home/home/Logout";
}

function editarLocation(action){
    
    setTimeout(function(){
        window.location.href = "http://localhost/serralheria/cadastro/"+action;
    }, 
    3000);
    
    
    
}

function get_img(){
    var url = $("#user").attr("src");
    return url;
}

function get_nome(){
    var nome = $("#nome_usuario").text();
    return nome;
}

function url_upload(method = null){
    
    if(method == null){
        var result = 'upload';
    }else{
        var result = method
    }
    
    return "http://localhost/serralheria/upload/upload/"+result;
}

function url_complet(method = null){
    
    if(method == null){
        var result = 'autoComplet';
    }else{
        var result = method
    }
    
    return "http://localhost/serralheria/utility/utility/"+result;
}

function mask(){
    $('input[data-mask=porcento]').mask('00,00');
    $('input[data-mask=altura]').mask('0,00');
    $('input[data-mask=peso]').mask('00,000');
    $('input[data-mask=data_site]').mask('00/00/0000');
    $('input[data-mask=time]').mask('00:00');
}

function mascara(o,f){
    v_obj=o;
    v_fun=f;
    setTimeout("execmascara()",1);
}

function execmascara(){
    v_obj.value=v_fun(v_obj.value);
}

function mk_soNumeros(v){
    return v.replace(/\D/g,"");
}

function data_via_ajax(){
    $("input[data-mask=data]").datepicker({
       language: 'pt-BR',
       format: 'dd/mm/yyyy',
       autoclose: true
      
   });
}

function Logout(){
    $.post(sair(),
            {cookie: encodeURIComponent(document.cookie),
            
            }, function (data) {
                $(location).attr('href', 'http://localhost/serralheria/');
        });
}

system = {
    autoComplet: function (_el,method = null,parameter = null){
        var str = $(_el).val();
        var data = $(_el).data("dados").split(",");
        var array = [data[0].split(':')[1],data[1].split(':')[1],data[2].split(':')[1],data[3].split(':')[1]];
        
        if(method == null){
        var result = 'autoComplet';
        }else{
            var result = method
        }
        
        if(parameter == null){
            var param  = null
        }else{
            var param = parameter
        }
        
        
        
        if(str == ""){
            
            $(_el).parents('.auto').find('#result').empty();
            
        }else{
            $.post(url_complet(result),
            {cookie: encodeURIComponent(document.cookie),
                data:array,
                valor:$(_el).val(),
                param:param
            }, function (data) {
                $(_el).parents('.auto').find('.option-list').html(data);
                
            });
        }
    },
    
    select : function (_el){
        var id = $(_el).data("id");
        var valor = $(_el).text();
        
        $(_el).parents('.auto').find('input.value').val(id);
        $(_el).parents('.auto').find('input.input').val(valor);
        $(_el).parents('.auto').find('.option-list').empty();
    },
    
    paginacaoSystem : function(_el){
        var valor = $(_el).data("paginacao");
        var mod = valor*10 - 10;
        
        if(valor >= 2){
            var soma = valor + 1
        }else{
            var soma = 4;
        }
        
        if(valor !=  1){
            var back = valor -1;
            
            $("#back").html("<a href='javascript:;' onclick='system.paginacaoSystem(this)' data-paginacao="+back+" class='btn btn-primary btn-sm btn-alt btn-round mr5 mb10'><<<</a>");
            $("#go").html("<a href='javascript:;' onclick='system.paginacaoSystem(this)' data-paginacao="+soma+" class='btn btn-primary btn-sm btn-alt btn-round mr5 mb10'>"+soma+"</a>");
        }else{
            $("#back").empty();
            $("#go").empty();
        }
        
        $.post(url_post('paginacao'),
                {cookie: encodeURIComponent(document.cookie),
                   valor:mod  
                }, function (data) {
                    if(data <= 0){
                        $("#go").empty();
                        $("#lista").empty();
                    }else{
                        
                        $("#lista").html(data);
                    }
            });
        
    },
    
    
    
};



